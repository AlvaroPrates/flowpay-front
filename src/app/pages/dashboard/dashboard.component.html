<div class="dashboard-container">
  <!-- Header -->
  <app-header></app-header>

  <!-- Main Content -->
  <div class="dashboard-content">
    <div class="content-wrapper">

      <!-- Status Bar -->
      <div class="status-bar">
        <div class="status-item">
          <mat-icon [class.connected]="wsConnected" [class.disconnected]="!wsConnected">
            {{ wsConnected ? 'wifi' : 'wifi_off' }}
          </mat-icon>
          <span class="status-text">
            {{ wsConnected ? 'Tempo Real Ativo' : 'Conectando...' }}
          </span>
        </div>

        <div class="last-update">
          <mat-icon>schedule</mat-icon>
          <span>Atualizado agora</span>
        </div>
      </div>

      <!-- Metrics Panel -->
      <app-metrics-panel [metricas]="metricas"></app-metrics-panel>

      <!-- Teams Tabs -->
      <mat-card class="teams-card">
        <mat-tab-group
          #tabGroup
          animationDuration="300ms"
          class="teams-tabs"
          [selectedIndex]="0">

          @for (time of times; track time) {
            <mat-tab>
              <ng-template mat-tab-label>
                <div class="tab-label">
                  <mat-icon>group</mat-icon>
                  <span>{{ getTimeLabel(time) }}</span>
                  @if (metricas) {
                    <mat-chip
                      class="tab-badge"
                      [class.has-queue]="metricas.filasPorTime[time] > 0">
                      {{ metricas.filasPorTime[time] || 0 }}
                    </mat-chip>
                  }
                </div>
              </ng-template>

              <div class="tab-content">
                <app-team-section [time]="time"></app-team-section>
              </div>
            </mat-tab>
          }
        </mat-tab-group>
      </mat-card>

    </div>
  </div>

  <!-- Loading Overlay -->
  @if (loading) {
    <div class="loading-overlay">
      <mat-spinner diameter="60"></mat-spinner>
      <p>Carregando dashboard...</p>
    </div>
  }
</div>
